# 欸米航空訂票系統 ✈️

一個完整的航空訂票網站，使用 React + TypeScript 開發，包含航班搜尋、價格日曆、購物車、付款、訂單記錄和旅行地圖功能。

## 🚀 快速開始

```bash
# 1. 安裝依賴
npm install

# 2. 啟動開發伺服器
npm run dev

# 3. 開啟瀏覽器
http://localhost:5173
```

> **提示**: 按 `Cmd+Shift+R` (Mac) 或 `Ctrl+Shift+R` (Windows) 強制重新載入頁面

---

## ✨ 核心功能

### 📋 完整訂票流程

1. **行程選擇** - 來回票 / 單程票 / 多個航段（最多4程）
2. **航班搜尋** - 選擇出發地、目的地、日期、艙等
3. **📅 價格日曆** - 查看前後日期價格，點擊切換航班
4. **航班選擇** - 查看詳細資訊，加入購物車
5. **購物車管理** - 查看、刪除已選航班
6. **完成付款** - 多種付款方式，動態表單驗證
7. **訂單記錄** - 查看歷史訂單
8. **旅行地圖** - 視覺化展示去過的地方

---

## 🎯 特色功能

### 📅 新日曆系統（重點功能）

#### 搜尋表單日曆
- **統一設計風格** - 所有票種使用相同的日曆組件
- **範圍選擇高亮** - 來回票選擇時，中間日期會被高亮顯示
- **確認按鈕** - 選好日期後點擊確認才會套用
- **關閉按鈕** - 右上角 ✕ 按鈕可快速關閉
- **無價格顯示** - 簡潔清爽的日期選擇介面
- **單程模式** - 單程票只能選擇一個日期
- **多個航段支援** - 每個航段獨立選擇日期和艙等

#### 價格比較日曆
- **完整日曆視圖** - 顯示整月日期和價格
- **價格趨勢** - 一目了然查看各日期的價格差異
- **重新選擇日期** - 可以改變去程或回程日期
- **即時更新** - 選擇日期後航班列表立即更新
- **週末標示** - 紅色背景標示週末

### 🎨 設計特色

- **星宇航空風格** - 深藍色 + 金色配色
- **響應式設計** - 支援所有裝置
- **流暢動畫** - 平滑的過渡效果
- **現代化 UI** - 卡片式設計，清楚易懂

### 🗺️ 旅行地圖

- **互動式地圖** - 可縮放、拖動（參考 hw1 實現）
- **邊界限制** - 拖動到邊界會自動反彈
- **機場標記** - 🏳️ 旗幟標示訪問過的機場
- **統計資訊** - 顯示各洲國家數量

### 💳 付款系統

#### 支援付款方式
- **信用卡 / 金融卡**
  - 持卡人姓名
  - 卡號
  - 有效期限
  - 安全碼（CVV）
  - 帳單地址

- **ATM 轉帳**
  - 銀行代碼與帳號（自動顯示）
  - 轉帳金額（自動計算）
  - 轉帳後5碼
  - 轉帳日期

#### 動態表單
- 根據付款方式顯示不同欄位
- 即時表單驗證
- 付款處理動畫

---

## 📊 航班資料

### CSV 檔案配置

**位置**: `public/flights.csv`

**航班數量**: 8,214 個航班
**日期範圍**: 2025-10-13 至 2026-01-31
**航線數**: 38 條（含去回程）

### 班機號碼系統

- **格式**: AM001 - AM076
- **規則**: 
  - 同一航線同一時段的班機，每天使用相同號碼
  - 來回班機號碼相差 1
  - 例如：臺北→東京 AM002，東京→臺北 AM001

### 飛機型號與座位

#### 亞洲航線（小飛機）
- **型號**: A321neo
- **座位**: 180 座
- **配置**: 頭等 9 座 (5%) / 商務 27 座 (15%) / 經濟 144 座 (80%)

#### 其他航線（大飛機）
- **型號**: A350-900
- **座位**: 300 座
- **配置**: 頭等 15 座 (5%) / 商務 45 座 (15%) / 經濟 240 座 (80%)

### 價格規則

- **平日**: 基礎價格
- **週末**: +2,000 元
- **聖誕節期間** (12/21-12/27): +3,000 元
- **新年期間** (12/30-1/3): +3,000 元

### 修改航班資料

編輯 `public/flights.csv`：

```csv
flightNumber,departure,destination,departureDate,departureTime,arrivalTime,duration,price_economy,price_business,price_first,aircraft,availableSeats
AM002,臺北 TPE,東京 NRT,2025-10-13,08:30,12:00,3h15m,10500,27000,47000,A321neo,180
```

---

## 🗺️ 支援航線

### 亞洲
- 🇯🇵 **日本**: 東京(NRT/HND)、大阪、福岡、名古屋
- 🇰🇷 **韓國**: 首爾
- 🇭🇰 **香港** / 🇲🇴 **澳門**
- 🇨🇳 **中國**: 上海、北京、廣州
- 🇸🇬 **新加坡** / 🇹🇭 **泰國**: 曼谷
- 🇵🇭 **菲律賓**: 馬尼拉
- 🇻🇳 **越南**: 胡志明市、河內

### 美洲
- 🇺🇸 **美國**: 洛杉磯、舊金山、西雅圖

### 歐洲
- 🇬🇧 **英國**: 倫敦

### 大洋洲
- 🇦🇺 **澳洲**: 雪梨

### 國內
- 臺北松山 (TSA) 短程航線

---

## 🎯 使用說明

### 來回票完整流程

1. **搜尋航班**
   - 選擇「來回」
   - 出發地：臺北 TPE
   - 目的地：東京 NRT
   - 出發日期：2025/10/16
   - 回程日期：2025/10/20
   - 艙等：經濟艙

2. **選擇去程航班**
   - 查看價格日曆，比較不同日期
   - 選擇合適的航班
   - 點擊「選擇」按鈕

3. **選擇回程航班**
   - 系統自動顯示回程航班
   - 同樣可以查看價格日曆
   - 選擇回程航班

4. **購物車確認**
   - 兩張機票同時加入購物車
   - 檢查航班資訊和總金額
   - 點擊「前往付款」

5. **完成付款**
   - 選擇付款方式
   - 填寫必要資訊
   - 確認付款

### 單程票流程

```
選擇「單程」→ 選擇出發地和目的地 
→ 選擇日期 → 搜尋 
→ 查看價格日曆 → 選擇航班 
→ 加入購物車 → 付款
```

### 多個航段流程

```
選擇「多個航段」→ 填寫各程資訊（最多4程）
→ 每個航段可選擇不同艙等
→ 搜尋 → 逐一選擇各程航班
→ 完成後前往付款
```

---

## 📊 技術棧

- **React 18** - 現代化 UI 框架
- **TypeScript** - 型別安全
- **React Router** - 頁面路由管理
- **Vite** - 極速建置工具
- **PapaParse** - CSV 資料解析
- **Leaflet** - 互動式地圖
- **LocalStorage** - 資料持久化

---

## 🛠️ 建置與部署

```bash
# 開發模式
npm run dev

# 建置專案
npm run build

# 預覽建置結果
npm run preview
```

---

## ❓ 常見問題

### Q: 價格日曆沒出現？
**A**: 確認選擇「來回」或「單程」（多個航段不顯示價格日曆），並已成功搜尋到航班。

### Q: 點擊日期後航班沒更新？
**A**: 已修復！現在點擊日期會立即重新搜尋並更新航班列表。

### Q: 如何清除測試資料？
**A**: 
1. 打開瀏覽器開發者工具 (F12)
2. Console 執行 `localStorage.clear()`
3. 重新整理頁面

### Q: 搜尋表單的日曆怎麼用？
**A**: 
- 來回票：先點選出發日期，再點選回程日期，中間日期會高亮
- 單程票：只需選擇一個日期
- 選好後記得點「確認」按鈕
- 右上角 ✕ 可關閉日曆

### Q: 價格是怎麼計算的？
**A**: 
- 基礎價格來自 CSV 檔案
- 週末自動 +2,000 元
- 聖誕節期間 (12/21-27) +3,000 元
- 新年期間 (12/30-1/3) +3,000 元

### Q: 旅行地圖可以縮放嗎？
**A**: 可以！地圖支援：
- 滾輪縮放 (最小 2 級，最大 10 級)
- 拖動移動
- 拖到邊界會自動反彈

---

## 📝 更新日誌

### v3.0.0 (2025/10/13)
- ✨ 全新日曆系統
  - 統一的搜尋表單日曆
  - 範圍選擇高亮功能
  - 確認和關閉按鈕
  - 移除價格顯示
- ✨ 多個航段功能
  - 每個航段獨立選擇艙等
  - 獨立的日曆選擇
- ✨ CSV 資料更新
  - 8,214 個航班
  - 班機號碼改為 AM 開頭
  - 飛機型號按航線區分
  - 特殊日期加價
- ✨ 旅行地圖優化
  - 參考 hw1 實現
  - 邊界反彈效果
  - 更流暢的縮放和拖動

### v2.3.0
- ✨ 價格日曆（點擊日期切換航班）
- ✨ 往前/往後一天導航
- ✨ 優化的付款表單

### v2.0.0
- ✨ 往返航班選擇流程
- ✨ 訂單記錄頁面
- ✨ 旅行地圖視覺化
- ✨ 資料持久化

---

## 📄 授權

此專案僅供學習使用。

---

**版本**: v3.0.0  
**狀態**: ✅ 所有功能完成  
**開發伺服器**: 🟢 http://localhost:5173

**重要提示**: 
- 請按 `Cmd+Shift+R` 強制重新載入頁面！
- CSV 檔案變更後需重新整理
- 航班數據為模擬資料
