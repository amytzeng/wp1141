# ✅ 測試圖片上傳功能

## 快速測試（3 分鐘）

### 方式 1：使用 Base64（最簡單，無需設定）

1. **啟動開發伺服器**
   ```bash
   npm run dev
   ```

2. **登入 Echo**
   - 前往 http://localhost:3000
   - 使用 Google 登入
   - 設定 userId

3. **前往個人頁面**
   - 點擊側邊欄的「Profile」

4. **編輯個人資料**
   - 點擊「Edit Profile」按鈕

5. **測試上傳頭像**
   - 方法 A：滑鼠移到頭像上，點擊相機圖示 📷
   - 方法 B：點擊「上傳頭像」按鈕
   - 選擇一張圖片（建議小於 1MB）
   - 等待預覽出現

6. **測試上傳背景圖**
   - 滑鼠移到背景圖區域
   - 點擊「上傳背景圖」按鈕
   - 選擇一張圖片（建議小於 2MB）
   - 等待預覽出現

7. **儲存**
   - 點擊右上角「儲存」按鈕
   - 重新整理頁面，確認圖片有顯示

### 方式 2：使用 Cloudinary（推薦，需 5 分鐘設定）

1. **設定 Cloudinary**（詳見 `圖片上傳設定.md`）
   - 註冊 https://cloudinary.com/
   - 取得 Cloud Name
   - 建立 `echo_preset` Upload Preset（Unsigned）

2. **更新 .env**
   ```bash
   NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME="你的cloud-name"
   ```

3. **重啟伺服器**
   ```bash
   npm run dev
   ```

4. **按照方式 1 的步驟 2-7 測試**

---

## 🎯 測試重點

### ✅ 應該可以運作的

- [ ] 點擊頭像上的相機圖示可以上傳
- [ ] 點擊「上傳頭像」按鈕可以上傳
- [ ] 點擊「上傳背景圖」按鈕可以上傳
- [ ] 上傳後立即看到預覽
- [ ] 儲存後圖片保留
- [ ] 重新整理頁面圖片還在
- [ ] 上傳中顯示「上傳中...」
- [ ] 可以輸入圖片 URL 作為替代方案

### ⚠️ 應該被阻止的

- [ ] 上傳超過 5MB 的檔案 → 顯示錯誤
- [ ] 上傳非圖片檔案（如 .txt, .pdf）→ 顯示錯誤
- [ ] 上傳時不能點擊其他上傳按鈕

---

## 🔍 除錯檢查

### 如果上傳失敗

1. **打開 Browser Console**（F12）
2. **查看錯誤訊息**
3. **常見問題：**

#### Error: "圖片上傳失敗"（使用 Cloudinary 時）

**檢查：**
- `.env` 的 `NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME` 是否正確
- Cloudinary Upload Preset 名稱是否為 `echo_preset`
- Upload Preset 的 Signing Mode 是否為 `Unsigned`

**解決：**
```bash
# 確認環境變數
echo $NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME

# 重啟伺服器
npm run dev
```

#### Error: "圖片大小不能超過 5MB"

**解決：** 使用圖片壓縮工具（如 [TinyPNG](https://tinypng.com/)）

#### Error: "只能上傳圖片檔案"

**解決：** 確保選擇的是 `.jpg`, `.png`, `.gif`, `.webp` 等圖片格式

---

## 📊 預期結果

### Base64 模式

- ✅ 上傳速度：快（本地處理）
- ✅ 圖片顯示：即時
- ⚠️ 資料庫大小：會變大
- ⚠️ 適合：開發、作業、小圖片

### Cloudinary 模式

- ✅ 上傳速度：中等（上傳到雲端）
- ✅ 圖片顯示：快速（CDN）
- ✅ 資料庫大小：不變（只存 URL）
- ✅ 圖片優化：自動
- ✅ 適合：正式環境、大圖片

---

## 🎨 使用體驗

### 頭像上傳

1. 滑鼠移到頭像上
2. 出現半透明黑色遮罩
3. 相機圖示 📷 出現
4. 點擊後選擇圖片
5. 預覽立即更新
6. 點擊「儲存」

### 背景圖上傳

1. 滑鼠移到背景圖區域
2. 出現半透明黑色遮罩
3. 「上傳背景圖」按鈕出現
4. 點擊後選擇圖片
5. 預覽立即更新
6. 點擊「儲存」

### 替代方案：使用 URL

1. 從其他網站複製圖片網址
2. 貼到「或輸入 URL」欄位
3. 預覽立即更新
4. 點擊「儲存」

---

## 🚀 進階測試

### 1. 測試不同圖片格式

- [ ] JPEG (.jpg)
- [ ] PNG (.png)
- [ ] GIF (.gif) - 包括動畫
- [ ] WEBP (.webp)
- [ ] SVG (.svg)

### 2. 測試不同圖片大小

- [ ] 100KB - 小圖
- [ ] 1MB - 中圖
- [ ] 3MB - 大圖
- [ ] 5MB - 極限
- [ ] 6MB - 應該被拒絕

### 3. 測試邊緣情況

- [ ] 超寬圖片（10000x100）
- [ ] 超高圖片（100x10000）
- [ ] 方形圖片（1000x1000）
- [ ] 非常小的圖片（50x50）

---

## ✨ 完成！

如果以上測試都通過，恭喜你！圖片上傳功能已經完全運作了 🎉

現在使用者可以：
- ✅ 上傳自己的頭像
- ✅ 上傳自己的背景圖
- ✅ 使用圖片 URL
- ✅ 即時預覽
- ✅ 檔案大小檢查
- ✅ 檔案類型檢查
- ✅ 上傳狀態顯示

---

**下一步：** 部署到 Vercel 時，記得在環境變數中加入 `NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME`！

